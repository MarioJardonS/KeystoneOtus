---
title: "Untitled"
output: html_document
date: '2023-09-27'
---


#Otus centrales de tomate según muestras divididas

```{r}
muestras_tomate <- c("desarrollo" , "no_desarrollo" , "totales")
```

```{r}
otus_tomate_desarrollo <- read.csv("../central_otus/otus_centrales_tomate_desarrollo" , row.names = 1)
otus_tomate_no_desarrollo <- read.csv("../central_otus/otus_centrales_tomate_no_desarrollo.csv" , row.names = 1)

otus_centrales_tomate2 <- list(otus_tomate_desarrollo , otus_tomate_no_desarrollo , otus_centrales_tomate)
```

```{r}
taxa_centrales_tomate <- list()
for (i in 1:2){
  taxa_centrales_tomate[[i]] <- rizosferas[[2]]@tax_table@.Data[row.names(otus_centrales_tomate2[[i]]),]
  print( paste0( "Se obtuvieron "  , length(row.names(otus_centrales_tomate2[[i]])) , " OTUs centrales en las muestras de " , muestras_tomate[i] ) )
}

taxa_centrales_tomate[[3]] <- taxa_centrales[[2]]
```


```{r}
pares <- list(c(1,2) , c(1,3) , c(2,3))
for (i in 1:3){
  print(intersect(as.vector(taxa_centrales_tomate[[pares[[i]][1]]][ , "Rank5"]) , as.vector(taxa_centrales_tomate[[pares[[i]][2]]][ , "Rank5"]) ))
}
```

```{r}
pares <- list(c(1,2) , c(1,3) , c(2,3))
for (i in 1:3){
  print(intersect(as.vector(taxa_centrales_tomate[[pares[[i]][1]]][ , "Rank6"]) , as.vector(taxa_centrales_tomate[[pares[[i]][2]]][ , "Rank6"]) ))
}
```

```{r}
pares <- list(c(1,2) , c(1,3) , c(2,3))
for (i in 1:3){
  print(intersect(as.vector(taxa_centrales_tomate[[pares[[i]][1]]][ , "Rank7"]) , as.vector(taxa_centrales_tomate[[pares[[i]][2]]][ , "Rank7"]) ))
}
```

Entre las principales coincidencias entre los diversos Otus centrales de rizósfera de tomate se encuentran la abundancia del género Pseudomonas y la presencia de especies del género Candidatus.
```{r}
print(taxa_centrales_tomate[[1]][ , c( "Rank7")])
```
```{r}
print(taxa_centrales_tomate[[2]][ , c( "Rank7")])
```


```{r}
data_tomate_desarrollo <- read.csv("../../data/tables/tomate_desarrollo.csv" , row.names = 1, header = TRUE )

medias <- c()
medianas <- c()
for (i in 1:dim(data_tomate_desarrollo)[2]){
  medias <- c(medias , mean(data_tomate_desarrollo[ , i]))
  medianas <- c(medianas , median(data_tomate_desarrollo[ , i]))
  }

data_tomate_desarrollo <- data_tomate_desarrollo[ row.names(otus_centrales_tomate2[[1]]),]
data_tomate_desarrollo <- rbind(medias , data_tomate_desarrollo)
data_tomate_desarrollo <- rbind(medianas , data_tomate_desarrollo)

row.names(data_tomate_desarrollo) <- c("Medianas" , "Medias" , row.names(otus_centrales_tomate2[[1]]))
data_tomate_desarrollo
```

```{r}
data_tomate_no_desarrollo <- read.csv("../../data/tables/tomate_no_desarrollo.csv" , row.names = 1, header = TRUE )

medias <- c()
medianas <- c()
for (i in 1:dim(data_tomate_no_desarrollo)[2]){
  medias <- c(medias , mean(data_tomate_no_desarrollo[ , i]))
  medianas <- c(medianas , median(data_tomate_no_desarrollo[ , i]))
  }

data_tomate_no_desarrollo <- data_tomate_no_desarrollo[ row.names(otus_centrales_tomate2[[2]]),]
data_tomate_no_desarrollo <- rbind(medias , data_tomate_no_desarrollo)
data_tomate_no_desarrollo <- rbind(medianas , data_tomate_no_desarrollo)

row.names(data_tomate_no_desarrollo) <- c("Medianas" , "Medias" , row.names(otus_centrales_tomate2[[2]]))
data_tomate_no_desarrollo
```




```{r}
V(redes[[3]])$label <- NA
V(redes[[3]])$size <- 3
plot(redes[[3]])
```
```{r}
nombres_otus_centrales_maiz <- as.character(otus_centrales[[3]][,"nodos"])
red_otus_centrales_maiz <- induced_subgraph(redes[[3]], nombres_otus_centrales_maiz  ,"auto")
print( otus_centrales[[3]][,"nodos"])

print(row.names(otus_centrales[[3]]))
print(degree( red_otus_centrales_maiz))
#V(net_work_centrales)$label <- tax_centrales[,"Rank7"]
```



```{r}
plot(red_otus_centrales_maiz)

```


```{r}
otus_no_centrales_maiz <- names(V(redes[[3]]))[ is.element(names(V(redes[[3]])), nombres_otus_centrales_maiz) == FALSE]
red_otus_no_centrales_maiz <- induced_subgraph(redes[[3]] , otus_no_centrales_maiz , "auto" )
plot(red_otus_no_centrales_maiz)
```











